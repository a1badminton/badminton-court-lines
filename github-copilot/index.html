<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Badminton Court Trainer - Phaser</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.min.js"></script>
  <style>
    body { margin: 0; padding: 0; background: #f6f8fa; font-family: sans-serif; }
    #controls { text-align: center; margin: 1em; }
    button { margin: 0 0.5em 0.5em 0; padding: 0.5em 1em; font-size: 1em; border-radius: 5px; border: none; background: #1976d2; color: white; cursor: pointer;}
    button.secondary { background: #888; }
    #info { max-width: 700px; margin: 1em auto; background: #fff; border-radius: 8px; box-shadow: 0 0 12px #ccc; padding: 1em;}
    #phaser { margin: 0 auto; display: block; }
  </style>
</head>
<body>
  <header style="padding:1em;background:#1976d2;color:white;text-align:center;font-size:1.5em;">
    Badminton Court Trainer (Phaser)
  </header>
  <div id="controls">
    <button id="teachBtn">Teach Mode</button>
    <button id="quizBtn" class="secondary">Quiz Mode</button>
  </div>
  <div id="info"></div>
  <div id="phaser"></div>

<script>
const COURT = {
  x: 50, y: 50, width: 300, height: 700,
  singlesLeft: 90, singlesRight: 310, doublesLeft: 50, doublesRight: 350,
  baselineTop: 50, baselineBottom: 750,
  shortService: 210, longServiceSingles: 650, longServiceDoubles: 690,
  centerX: 200
};

const lines = [
  { id: 'baseline-top', name: 'Top Baseline', desc: 'The back boundary line on the top side.', coords: [COURT.doublesLeft, COURT.baselineTop, COURT.doublesRight, COURT.baselineTop] },
  { id: 'baseline-bottom', name: 'Bottom Baseline', desc: 'The back boundary line on the bottom side.', coords: [COURT.doublesLeft, COURT.baselineBottom, COURT.doublesRight, COURT.baselineBottom] },
  { id: 'sideline-left-singles', name: 'Left Singles Sideline', desc: 'Left boundary for singles play.', coords: [COURT.singlesLeft, COURT.baselineTop, COURT.singlesLeft, COURT.baselineBottom] },
  { id: 'sideline-right-singles', name: 'Right Singles Sideline', desc: 'Right boundary for singles play.', coords: [COURT.singlesRight, COURT.baselineTop, COURT.singlesRight, COURT.baselineBottom] },
  { id: 'sideline-left-doubles', name: 'Left Doubles Sideline', desc: 'Left boundary for doubles play.', coords: [COURT.doublesLeft, COURT.baselineTop, COURT.doublesLeft, COURT.baselineBottom] },
  { id: 'sideline-right-doubles', name: 'Right Doubles Sideline', desc: 'Right boundary for doubles play.', coords: [COURT.doublesRight, COURT.baselineTop, COURT.doublesRight, COURT.baselineBottom] },
  { id: 'center-line', name: 'Center Line', desc: 'Divides the service courts.', coords: [COURT.centerX, COURT.shortService, COURT.centerX, COURT.longServiceSingles] },
  { id: 'short-service-line', name: 'Short Service Line', desc: 'Service must pass this line.', coords: [COURT.singlesLeft, COURT.shortService, COURT.singlesRight, COURT.shortService] },
  { id: 'long-service-line-singles', name: 'Long Service Line (Singles)', desc: 'Far boundary for singles service.', coords: [COURT.singlesLeft, COURT.longServiceSingles, COURT.singlesRight, COURT.longServiceSingles] },
  { id: 'long-service-line-doubles', name: 'Long Service Line (Doubles)', desc: 'Far boundary for doubles service.', coords: [COURT.doublesLeft, COURT.longServiceDoubles, COURT.doublesRight, COURT.longServiceDoubles] }
];

// Service courts as rectangles for highlight/quiz
const serviceCourts = [
  { id: 'left-service-court', name: 'Left Service Court', desc: 'Area to the left of the center line.', 
    rect: [COURT.singlesLeft, COURT.shortService, COURT.centerX-COURT.singlesLeft, COURT.longServiceSingles-COURT.shortService] },
  { id: 'right-service-court', name: 'Right Service Court', desc: 'Area to the right of the center line.', 
    rect: [COURT.centerX, COURT.shortService, COURT.singlesRight-COURT.centerX, COURT.longServiceSingles-COURT.shortService] }
];

let mode = 'teach'; // or 'quiz'
let currentQuiz = null;
let score = 0;
let total = 0;

// Phaser game config
const config = {
  type: Phaser.AUTO,
  parent: 'phaser',
  width: 400,
  height: 800,
  backgroundColor: '#f6f8fa',
  scene: {
    preload: function(){},
    create: create,
    restartCourt: restartCourt,
    showTeachCourt: showTeachCourt,
    showQuizCourt: showQuizCourt
  }
};

let game, scene;

function create() {
  scene = this;
  this.graphics = this.add.graphics();
  this.lineObjects = [];
  this.serviceObjects = [];
  restartCourt();

  // Input events for quiz/teach mode
  this.input.on('gameobjectdown', (pointer, obj) => {
    if(mode === 'teach') {
      info(obj.data.get('name'), obj.data.get('desc'));
      highlightObject(obj);
    } else if(mode === 'quiz') {
      if(currentQuiz && currentQuiz.id === obj.data.get('id')) {
        score++; feedback(`✅ Correct! (${score}/${total})`);
        highlightObject(obj);
      } else {
        feedback(`❌ Incorrect. That was ${obj.data.get('name')}. (${score}/${total})`);
        highlightQuizObject(currentQuiz.id);
      }
      setTimeout(nextQuizQuestion, 1200);
    }
  });
}

function restartCourt() {
  scene.graphics.clear();
  drawCourt();
  makeInteractiveLines();
  makeInteractiveServiceCourts();
}

function drawCourt() {
  // Outer court
  scene.graphics.lineStyle(4, 0x222222);
  scene.graphics.strokeRect(COURT.doublesLeft, COURT.baselineTop, COURT.doublesRight-COURT.doublesLeft, COURT.baselineBottom-COURT.baselineTop);
  // Singles court
  scene.graphics.lineStyle(2, 0x1976d2);
  scene.graphics.strokeRect(COURT.singlesLeft, COURT.baselineTop, COURT.singlesRight-COURT.singlesLeft, COURT.baselineBottom-COURT.baselineTop);
  // Service courts fill (light blue)
  serviceCourts.forEach(sc => {
    scene.graphics.fillStyle(0xe3f2fd, 0.4);
    scene.graphics.fillRect(...sc.rect);
  });
}

function makeInteractiveLines() {
  scene.lineObjects.forEach(obj => obj.destroy());
  scene.lineObjects = lines.map(line => {
    const obj = scene.add.line(0, 0, ...line.coords, 0x1976d2).setLineWidth(8,8).setOrigin(0);
    obj.setInteractive({ useHandCursor: true, hitArea: new Phaser.Geom.Line(...line.coords), hitAreaCallback: Phaser.Geom.Line.Contains });
    obj.data = new Phaser.Data.DataManager(obj);
    obj.data.set('name', line.name);
    obj.data.set('desc', line.desc);
    obj.data.set('id', line.id);
    return obj;
  });
}

function makeInteractiveServiceCourts() {
  scene.serviceObjects.forEach(obj => obj.destroy());
  scene.serviceObjects = serviceCourts.map(area => {
    const obj = scene.add.rectangle(area.rect[0]+area.rect[2]/2, area.rect[1]+area.rect[3]/2, area.rect[2], area.rect[3], 0xe3f2fd, 0.01);
    obj.setInteractive({ useHandCursor: true });
    obj.data = new Phaser.Data.DataManager(obj);
    obj.data.set('name', area.name);
    obj.data.set('desc', area.desc);
    obj.data.set('id', area.id);
    return obj;
  });
}

function info(name, desc) {
  document.getElementById('info').innerHTML = `<h3>${name}</h3><p>${desc}</p>`;
}
function feedback(msg) {
  document.getElementById('info').innerHTML = `<div style="font-weight:bold">${msg}</div>`;
}
function highlightObject(obj) {
  restartCourt();
  if(obj.type === 'Line') {
    obj.setStrokeStyle(12, 0xff9800);
  } else if(obj.type === 'Rectangle') {
    obj.setFillStyle(0xff9800, 0.4);
  }
}
function highlightQuizObject(id) {
  restartCourt();
  [...scene.lineObjects, ...scene.serviceObjects].forEach(o => {
    if(o.data.get('id') === id) highlightObject(o);
  });
}

function showTeachCourt() {
  mode = 'teach';
  score = 0; total = 0; currentQuiz = null;
  restartCourt();
  info('Tap a line or court area to learn its name and purpose.', '');
}
function showQuizCourt() {
  mode = 'quiz';
  score = 0; total = 0;
  restartCourt();
  nextQuizQuestion();
}
function nextQuizQuestion() {
  total++;
  currentQuiz = Phaser.Utils.Array.GetRandom([...lines, ...serviceCourts]);
  feedback(`<b>Which line or area is: <span style="color:#1976d2">${currentQuiz.name}</span>?</b><br><small>Tap on the court to answer.</small>`);
  highlightQuizObject(null);
}

// UI events
document.getElementById('teachBtn').onclick = () => { scene.showTeachCourt(); };
document.getElementById('quizBtn').onclick = () => { scene.showQuizCourt(); };

// Start game
game = new Phaser.Game(config);

</script>
</body>
</html>